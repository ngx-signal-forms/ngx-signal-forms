<div class="demo-container">
  <div class="demo-header">
    <h1>CSS Status Classes</h1>
    <p class="lead">
      Align CSS class application with error display strategies for consistent
      UX.
    </p>
  </div>

  <section class="concept-explanation">
    <h2>The Problem: Timing Mismatch</h2>
    <p>
      Angular Signal Forms (21.1+) supports CSS status classes via
      <code>provideSignalFormsConfig</code>, but by default they apply
      <strong>immediately</strong>. When using the toolkit's
      <code>'on-touch'</code> error display strategy, users see red borders
      <em>before</em> error messages appearâ€”confusing!
    </p>
    <p>
      <strong>Solution:</strong> The toolkit's
      <code>ngxStatusClasses()</code> utility syncs CSS class application with
      your error display strategy.
    </p>
  </section>

  <section class="integration-explanation">
    <h3>Status Classes + CSS Custom Properties</h3>
    <p>These two systems work together:</p>
    <ul>
      <li>
        <strong>Status Classes</strong>: Control <em>when</em> CSS classes are
        applied (timing/strategy)
      </li>
      <li>
        <strong>CSS Custom Properties</strong>: Control <em>how</em> those
        states are styled (appearance)
      </li>
    </ul>
    <p>
      Example: <code>.ng-invalid</code> class is applied based on strategy
      (on-touch vs immediate), then CSS uses <code>--error-color</code> variable
      to style that state.
    </p>
  </section>

  <div class="comparison-grid three-column">
    <!-- Angular Native (No Toolkit) -->
    <section class="strategy-section">
      <div class="strategy-header angular-native">
        <h2>Angular Native</h2>
        <p class="strategy-description">
          Default Angular Signal Forms behavior (no toolkit customization).
        </p>
      </div>

      <form
        class="demo-form native-strategy native-form"
        (submit)="handleNativeSubmit($event)"
        novalidate
      >
        <div class="native-field">
          <label for="native-email">Email Address</label>
          <input
            id="native-email"
            type="email"
            class="native-input"
            [formField]="nativeForm.email"
            placeholder="you@example.com"
            [class.demo-invalid]="nativeClasses().invalid"
            [class.demo-valid]="nativeClasses().valid"
            [class.demo-touched]="nativeClasses().touched"
          />
          <p class="native-hint">Pure Angular (immediate classes)</p>
        </div>

        <div class="native-field">
          <label for="native-password">Password</label>
          <input
            id="native-password"
            type="password"
            class="native-input"
            [formField]="nativeForm.password"
            [class.demo-invalid]="nativeForm.password().invalid()"
            [class.demo-valid]="nativeForm.password().valid()"
            [class.demo-touched]="nativeForm.password().touched()"
          />
          <p class="native-hint">Min 8 characters</p>
        </div>

        <button type="submit">Submit Native Form</button>
      </form>

      <div class="state-inspector">
        <h3>Email Field State</h3>
        <dl>
          <dt>Invalid:</dt>
          <dd>{{ nativeClasses().invalid }}</dd>
          <dt>Valid:</dt>
          <dd>{{ nativeClasses().valid }}</dd>
          <dt>Touched:</dt>
          <dd>{{ nativeClasses().touched }}</dd>
          <dt>Dirty:</dt>
          <dd>{{ nativeClasses().dirty }}</dd>
        </dl>
        <p class="state-note angular-note">
          ðŸ“˜ <strong>Angular Default:</strong> Classes apply immediately based
          on validity state
        </p>
      </div>
    </section>

    <!-- Immediate Strategy -->
    <section class="strategy-section">
      <div class="strategy-header toolkit-immediate">
        <h2>Toolkit: 'immediate'</h2>
        <p class="strategy-description">
          CSS classes apply as soon as field becomes invalid/valid (matches
          Angular native).
        </p>
      </div>

      <form
        class="demo-form immediate-strategy"
        [ngxSignalForm]="immediateForm"
        (submit)="handleImmediateSubmit($event)"
      >
        <ngx-signal-form-field [formField]="immediateForm.email" outline>
          <label for="immediate-email">Email Address</label>
          <input
            id="immediate-email"
            type="email"
            [formField]="immediateForm.email"
            placeholder="you@example.com"
            [class.demo-invalid]="immediateClasses().invalid"
            [class.demo-valid]="immediateClasses().valid"
            [class.demo-touched]="immediateClasses().touched"
          />
          <ngx-signal-form-field-hint
            >Red border appears instantly</ngx-signal-form-field-hint
          >
        </ngx-signal-form-field>

        <ngx-signal-form-field [formField]="immediateForm.password" outline>
          <label for="immediate-password">Password</label>
          <input
            id="immediate-password"
            type="password"
            [formField]="immediateForm.password"
            [class.demo-invalid]="immediateForm.password().invalid()"
            [class.demo-valid]="immediateForm.password().valid()"
            [class.demo-touched]="immediateForm.password().touched()"
          />
          <ngx-signal-form-field-hint
            >Min 8 characters</ngx-signal-form-field-hint
          >
        </ngx-signal-form-field>

        <button type="submit">Submit Immediate Form</button>
      </form>

      <div class="state-inspector">
        <h3>Email Field State</h3>
        <dl>
          <dt>Invalid:</dt>
          <dd>{{ immediateClasses().invalid }}</dd>
          <dt>Valid:</dt>
          <dd>{{ immediateClasses().valid }}</dd>
          <dt>Touched:</dt>
          <dd>{{ immediateClasses().touched }}</dd>
          <dt>Dirty:</dt>
          <dd>{{ immediateClasses().dirty }}</dd>
        </dl>
        <p class="state-note immediate-note">
          âœ… <strong>Same as Angular:</strong> Red border appears immediately
        </p>
      </div>
    </section>

    <!-- On-Touch Strategy -->
    <section class="strategy-section">
      <div class="strategy-header toolkit-on-touch">
        <h2>Toolkit: 'on-touch'</h2>
        <p class="strategy-description">
          CSS classes apply only after blur or submit (toolkit enhancement
          synced with error display).
        </p>
      </div>

      <form
        class="demo-form on-touch-strategy"
        [ngxSignalForm]="onTouchForm"
        (submit)="handleOnTouchSubmit($event)"
      >
        <ngx-signal-form-field [formField]="onTouchForm.email" outline>
          <label for="on-touch-email">Email Address</label>
          <input
            id="on-touch-email"
            type="email"
            [formField]="onTouchForm.email"
            placeholder="you@example.com"
            [class.demo-invalid]="onTouchClasses().showInvalid"
            [class.demo-valid]="
              onTouchClasses().valid && onTouchClasses().touched
            "
            [class.demo-touched]="onTouchClasses().touched"
          />
          <ngx-signal-form-field-hint
            >Red border appears after blur</ngx-signal-form-field-hint
          >
        </ngx-signal-form-field>

        <ngx-signal-form-field [formField]="onTouchForm.password" outline>
          <label for="on-touch-password">Password</label>
          <input
            id="on-touch-password"
            type="password"
            [formField]="onTouchForm.password"
            [class.demo-invalid]="
              onTouchForm.password().invalid() &&
              onTouchForm.password().touched()
            "
            [class.demo-valid]="
              onTouchForm.password().valid() && onTouchForm.password().touched()
            "
            [class.demo-touched]="onTouchForm.password().touched()"
          />
          <ngx-signal-form-field-hint
            >Min 8 characters</ngx-signal-form-field-hint
          >
        </ngx-signal-form-field>

        <button type="submit">Submit On-Touch Form</button>
      </form>

      <div class="state-inspector">
        <h3>Email Field State</h3>
        <dl>
          <dt>Invalid:</dt>
          <dd>{{ onTouchClasses().invalid }}</dd>
          <dt>Valid:</dt>
          <dd>{{ onTouchClasses().valid }}</dd>
          <dt>Touched:</dt>
          <dd>{{ onTouchClasses().touched }}</dd>
          <dt>Show Invalid Class:</dt>
          <dd>
            <strong>{{ onTouchClasses().showInvalid }}</strong>
          </dd>
        </dl>
        <p class="state-note on-touch-note">
          ðŸŽ¯ <strong>Toolkit Enhancement:</strong> Red border and error message
          appear together after blur
        </p>
      </div>
    </section>
  </div>

  <section class="implementation-guide">
    <h2>Implementation</h2>

    <div class="approach-comparison">
      <div class="approach">
        <h3>Approach 1: Utility Function (Recommended)</h3>
        <p>Use when you need other Signal Forms config options:</p>
        <pre><code>import &#123; provideSignalFormsConfig &#125; from '@angular/forms/signals';
import &#123; ngxStatusClasses &#125; from '@ngx-signal-forms/toolkit';

export const appConfig: ApplicationConfig = &#123;
  providers: [
    provideSignalFormsConfig(&#123;
      classes: ngxStatusClasses(&#123; strategy: 'on-touch' &#125;),
      // Add other config here
    &#125;),
  ],
&#125;;</code></pre>
      </div>

      <div class="approach">
        <h3>Approach 2: Convenience Provider</h3>
        <p>Use when you <strong>only</strong> need status classes:</p>
        <pre><code>import &#123; provideNgxStatusClasses &#125; from '@ngx-signal-forms/toolkit';

export const appConfig: ApplicationConfig = &#123;
  providers: [
    provideNgxStatusClasses(&#123; strategy: 'on-touch' &#125;),
  ],
&#125;;</code></pre>
      </div>
    </div>

    <div class="css-integration">
      <h3>CSS Custom Properties Integration</h3>
      <p>Combine status classes with theme customization:</p>
      <pre><code>/* Define theme with CSS custom properties */
:root &#123;
  --error-color: #dc2626;
  --success-color: #10b981;
  --focus-color: #3b82f6;
&#125;

/* Use status classes with theme colors */
input.ng-invalid.ng-touched &#123;
  border-color: var(--error-color);
  background: color-mix(in srgb, var(--error-color) 5%, white);
&#125;

input.ng-valid.ng-touched &#123;
  border-color: var(--success-color);
&#125;

input:focus &#123;
  border-color: var(--focus-color);
  box-shadow: 0 0 0 3px color-mix(in srgb, var(--focus-color) 20%, transparent);
&#125;</code></pre>
    </div>
  </section>

  <section class="further-reading">
    <h2>Learn More</h2>
    <ul>
      <li>
        <a
          href="https://github.com/ngx-signal-forms/ngx-signal-forms/blob/main/packages/toolkit/README.md#automatic-status-classes"
        >
          Toolkit README - Complete API Reference
        </a>
      </li>
      <li>
        <a
          href="https://github.com/ngx-signal-forms/ngx-signal-forms/blob/main/packages/toolkit/form-field/THEMING.md"
        >
          Form Field Theming Guide - CSS Custom Properties
        </a>
      </li>
    </ul>
  </section>
</div>
