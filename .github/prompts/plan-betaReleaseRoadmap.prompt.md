# Plan: Beta Release Roadmap

**TL;DR**: Fix critical package metadata issues (peerDependencies), add API stability documentation, and ensure a11y behaviors match WCAG guidance before beta. Currently alpha-ready but not beta-ready.

## Steps

### 1. Fix package.json peerDependencies

**File**: `packages/toolkit/package.json`

Remove build tools that are incorrectly listed as peer dependencies:

- `@nx/vite`
- `vite`
- `@analogjs/vite-plugin-angular`

Add missing runtime peer dependencies:

- `@angular/forms` (>=21.1.0)
- `@angular/common` (>=21.1.0)

### 2. Fix core/package.json Angular peer versions

**File**: `packages/toolkit/core/package.json`

Change `"next"` to consistent `~21.1.0` to match root package:

```json
{
  "peerDependencies": {
    "@angular/common": "~21.1.0",
    "@angular/core": "~21.1.0"
  }
}
```

### 3. Implement WCAG-compliant live regions

**Files**: `packages/toolkit/core/components/form-error.component.ts`

Per [WCAG ARIA19](https://www.w3.org/WAI/WCAG22/Techniques/aria/ARIA19) and our [a11y.instructions.md](.github/instructions/a11y.instructions.md):

> **Errors (blocking issues)**: expose them in a container that is **present in the DOM on load**, marked with `role="alert"`, `aria-live="assertive"`, and `aria-atomic="true"`. **Update the container text instead of creating a brand-new node** so assistive technologies announce it reliably.

**Current behavior (incorrect)**: Container with `role="alert"` renders only when `showErrors()` is true.

**Required behavior (WCAG compliant)**: Container is always present in DOM; content inside updates dynamically.

```html
<!-- Container always present, content conditionally shown -->
<div
  [id]="errorId()"
  class="ngx-signal-form-error ngx-signal-form-error--error"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
>
  @if (showErrors() && hasErrors()) { @for (error of resolvedErrors(); track
  error.kind) {
  <p
    class="ngx-signal-form-error__message ngx-signal-form-error__message--error"
  >
    {{ error.message }}
  </p>
  } }
</div>
```

**Implementation notes**:

- Container must exist before errors appear (not conditionally rendered)
- Only the content inside the container is conditionally rendered
- Same pattern applies to warnings (`role="status"`, `aria-live="polite"`)

### 4. Add API stability policy to README.md

**File**: `packages/toolkit/README.md`

Add section documenting:

- Semver commitment
- Breaking change policy for 0.x versions (minor may include breaking)
- Deprecated API labeling convention
- Experimental API labeling convention (`@experimental` JSDoc tag)

### 5. CHANGELOG.md (auto-generated)

**Tool**: `nx release`

Do NOT create CHANGELOG.md manually. It will be auto-generated by `nx release` when publishing:

```bash
# Dry run to preview changelog
nx release --dry-run

# Actual release (creates changelog, bumps version, tags, publishes)
nx release
```

**Configuration** (already in `nx.json`):

```json
{
  "release": {
    "projects": ["toolkit"],
    "changelog": {
      "workspaceChangelog": { "createRelease": "github" },
      "projectChangelogs": true
    }
  }
}
```

---

## Further Considerations

### 1. ✅ Live regions - RESOLVED

Per WCAG ARIA19: Container must be present in DOM before content appears. **Option A is required.** See Step 3 above.

### 2. Breaking change policy before 1.0?

Should minor versions (0.x → 0.y) allow breaking changes?

**Recommendation**: Yes - document explicitly in README:

> During 0.x releases, minor version bumps may include breaking changes. Check CHANGELOG.md before upgrading. Patch releases (0.x.y) will never contain breaking changes.

### 3. ✅ Version bump strategy - DECIDED

First beta release: **`0.1.0-beta.1`**

Rationale: API is not yet proven stable in production. The `0.x` prefix communicates that breaking changes may occur in minor versions.

---

## Checklist for Beta Release

- [ ] Fix peerDependencies in `packages/toolkit/package.json`
- [ ] Fix Angular peer versions in `packages/toolkit/core/package.json`
- [ ] Implement WCAG-compliant live regions (always-present containers)
- [ ] Add API stability policy to README.md
- [ ] Bump version to `0.1.0-beta.1`
- [ ] Run full test suite (`nx run-many -t test lint`)
- [ ] Build and verify package (`nx build toolkit`)
- [ ] Run `nx release` to generate changelog, tag, and publish
